{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "contractor.schema.json",
  "title": "ratta auth/contractor.json",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "format_version",
    "kdf",
    "kdf_iterations",
    "salt_b64",
    "nonce_b64",
    "ciphertext_b64",
    "mode"
  ],
  "properties": {
    "format_version": {
      "type": "integer",
      "const": 1
    },
    "kdf": {
      "type": "string",
      "const": "pbkdf2-hmac-sha256"
    },
    "kdf_iterations": {
      "type": "integer",
      "const": 200000,
      "minimum": 1
    },
    "salt_b64": {
      "type": "string",
      "pattern": "^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$",
      "minLength": 1
    },
    "nonce_b64": {
      "type": "string",
      "pattern": "^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$",
      "minLength": 1
    },
    "ciphertext_b64": {
      "type": "string",
      "pattern": "^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$",
      "minLength": 1,
      "description": "AES-256-GCM ciphertext including tag."
    },
    "mode": {
      "type": "string",
      "const": "contractor"
    }
  }
}
